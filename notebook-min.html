<!doctype html><html lang=en><head><meta charset=UTF-8><meta name=viewport content="width=device-width,initial-scale=1,user-scalable=yes,maximum-scale=5"><meta name=description content="Private, offline note-taking application with encryption support"><meta name=theme-color content=#3b82f6><meta name=apple-mobile-web-app-capable content=yes><meta name=apple-mobile-web-app-status-bar-style content=default><meta name=apple-mobile-web-app-title content=Notebook><meta name=mobile-web-app-capable content=yes><title>üìù Notebook</title><style>*{margin:0;padding:0;box-sizing:border-box}body{font-family:-apple-system,BlinkMacSystemFont,'Segoe UI',Roboto,Oxygen,Ubuntu,Cantarell,sans-serif;background:#f8fafc;color:#334155;height:100vh;overflow:hidden}.app-container{display:grid;grid-template-columns:280px 320px 1fr;grid-template-rows:60px 1fr;height:100vh;gap:1px;background:#e2e8f0}.header{grid-column:1/-1;background:#fff;display:flex;align-items:center;justify-content:space-between;padding:0 24px;border-bottom:1px solid #e2e8f0;box-shadow:0 1px 3px rgba(0,0,0,.1);min-height:60px}.header-left{display:flex;align-items:center;gap:24px;flex:1;min-width:0}.header h1{font-size:1.5rem;font-weight:600;color:#1e293b;margin:0;white-space:nowrap}.header-controls{display:flex;align-items:center;gap:16px;flex-shrink:0}.encryption-controls{display:flex;align-items:center;gap:8px;padding:8px 12px;background:#fef3c7;border-radius:6px;border:1px solid #f59e0b}.encryption-controls label{font-size:.9rem;font-weight:500;color:#92400e;cursor:pointer}.encryption-controls input[type=checkbox]{cursor:pointer}.search-container{position:relative;width:100%;max-width:280px;min-width:200px;flex-shrink:1}.search-input{padding:8px 16px 8px 40px;border:1px solid #d1d5db;border-radius:8px;background:#f9fafb;font-size:14px;width:100%;transition:.2s;box-sizing:border-box}.search-input:focus{border-color:#3b82f6;background:#fff}.search-icon{position:absolute;left:12px;top:50%;transform:translateY(-50%);color:#6b7280}.sidebar{background:#fff;border-right:1px solid #e2e8f0;overflow-y:auto;overflow-x:hidden;scrollbar-width:thin}.sidebar-section{padding:24px;border-bottom:1px solid #f1f5f9}.sidebar-section h2{font-size:.875rem;font-weight:600;color:#6b7280;text-transform:uppercase;letter-spacing:.05em;margin-bottom:16px}.new-category-form{display:flex;gap:8px;margin-bottom:16px}.new-category-input{flex:1;padding:8px 12px;border:1px solid #d1d5db;border-radius:6px;font-size:14px}.new-category-input:focus{outline:0;border-color:#3b82f6;box-shadow:0 0 0 3px rgba(59,130,246,.1)}.btn{padding:8px 16px;border:none;border-radius:6px;font-size:14px;font-weight:500;cursor:pointer;transition:.2s;display:inline-flex;align-items:center;gap:6px}.btn-primary{background:#3b82f6;color:#fff}.btn-primary:hover{background:#2563eb}.btn-secondary{background:#f1f5f9;color:#475569}.btn-secondary:hover{background:#e2e8f0}.btn-danger{background:#ef4444;color:#fff}.btn-danger:hover{background:#dc2626}.category-list{list-style:none}.category-item{display:flex;align-items:center;justify-content:space-between;padding:12px 16px;margin:2px 0;border-radius:8px;cursor:pointer;transition:.2s;position:relative}.category-item:hover{background:#f8fafc}.category-item.active{background:#eff6ff;color:#2563eb;font-weight:500}.category-item.active::before{content:'';position:absolute;left:0;top:0;bottom:0;width:3px;background:#3b82f6;border-radius:0 2px 2px 0}.category-name{flex:1;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;min-width:0}.note-count{font-size:12px;color:#6b7280;background:#f1f5f9;padding:2px 6px;border-radius:10px;margin-right:8px}.delete-category{opacity:0;background:0 0;border:none;color:#ef4444;cursor:pointer;padding:4px;border-radius:4px;transition:.2s}.category-item:hover .delete-category{opacity:1}.delete-category:hover{background:#fef2f2}.note-list{background:#fff;border-right:1px solid #e2e8f0;overflow-y:auto;overflow-x:hidden}.note-list-header{padding:24px;border-bottom:1px solid #f1f5f9;display:flex;align-items:center;justify-content:space-between}.note-list-title{font-size:1.25rem;font-weight:600;color:#1e293b}.note-items{padding:12px;overflow-x:hidden}.note-item{padding:16px;border-radius:8px;margin-bottom:8px;cursor:pointer;transition:.2s;border:1px solid transparent}.note-item:hover{background:#f8fafc;border-color:#e2e8f0}.note-item.active{background:#eff6ff;border-color:#3b82f6;box-shadow:0 1px 3px rgba(59,130,246,.1)}.note-title{font-size:1rem;font-weight:600;color:#1e293b;margin-bottom:8px;line-height:1.4;word-wrap:break-word;overflow-wrap:break-word;hyphens:auto}.note-preview{font-size:.875rem;color:#6b7280;line-height:1.4;max-height:2.8em;overflow:hidden;display:-webkit-box;-webkit-line-clamp:2;-webkit-box-orient:vertical;word-wrap:break-word;overflow-wrap:break-word}.note-meta{display:flex;justify-content:space-between;align-items:center;margin-top:12px;font-size:.75rem;color:#9ca3af}.editor-panel{background:#fff;display:flex;flex-direction:column}.editor-header{padding:24px;border-bottom:1px solid #f1f5f9;display:flex;align-items:center;gap:12px}.editor-title-input{flex:1;font-size:1.5rem;font-weight:600;border:none;padding:8px 0;color:#1e293b;min-width:0;width:100%;box-sizing:border-box}.editor-title-input::placeholder{color:#9ca3af}.editor-toolbar{padding:12px 24px;border-bottom:1px solid #f1f5f9;display:flex;gap:8px;flex-wrap:wrap;background:#f8fafc;align-items:center;overflow-x:auto;scrollbar-width:thin}.toolbar-group{display:flex;gap:2px;padding:4px;border-radius:6px;background:#fff;border:1px solid #e2e8f0;flex-shrink:0}.toolbar-btn{padding:6px 8px;border:none;background:0 0;border-radius:4px;cursor:pointer;font-size:.875rem;transition:.2s;white-space:nowrap;min-width:32px;display:flex;align-items:center;justify-content:center}.toolbar-btn:hover{background:#f1f5f9;color:#3b82f6}.toolbar-btn.active{background:#3b82f6;color:#fff}.editor-content{flex:1;padding:24px;overflow-y:auto;overflow-x:hidden;scrollbar-width:thin;min-height:0}.editor{min-height:400px;outline:0;line-height:1.6;font-size:1rem;font-family:-apple-system,BlinkMacSystemFont,'Segoe UI',Roboto,Oxygen,Ubuntu,Cantarell,sans-serif;word-wrap:break-word;overflow-wrap:break-word;width:100%;box-sizing:border-box;height:auto}.editor:empty::before{content:"Start writing your note...";color:#9ca3af}.editor h1{font-size:2rem;font-weight:700;margin:24px 0 16px;color:#1e293b;border-bottom:2px solid #e2e8f0;padding-bottom:8px}.editor h2{font-size:1.5rem;font-weight:600;margin:20px 0 12px;color:#334155}.editor h3{font-size:1.25rem;font-weight:600;margin:16px 0 8px;color:#475569}.editor blockquote{border-left:4px solid #3b82f6;margin:16px 0;font-style:italic;color:#6b7280;background:#f8fafc;padding:12px 16px;border-radius:0 4px 4px 0}.editor pre{background:#f4f4f4;padding:12px;border-radius:4px;border-left:4px solid #3b82f6;margin:12px 0;overflow-x:auto;font-family:Monaco,Menlo,'Ubuntu Mono',monospace;font-size:.9rem}.editor table{border-collapse:collapse;width:100%;margin:16px 0;border:1px solid #e2e8f0;border-radius:6px;overflow:hidden}.editor table td,.editor table th{border:1px solid #e2e8f0;padding:8px 12px;text-align:left}.editor table th{background:#f8fafc;font-weight:600}.editor img{max-width:100%;height:auto;border-radius:4px;margin:8px 0;box-shadow:0 1px 3px rgba(0,0,0,.1)}.editor ol,.editor ul{padding-left:24px;margin:12px 0}.editor li{margin:4px 0}.status-bar{padding:12px 24px;border-top:1px solid #f1f5f9;background:#f8fafc;display:flex;justify-content:space-between;align-items:center;font-size:.875rem;color:#6b7280}.auto-save-indicator{display:flex;align-items:center;gap:6px}.save-dot{width:6px;height:6px;border-radius:50%;background:#10b981}.save-dot.saving{background:#f59e0b;animation:1s infinite pulse}@keyframes pulse{0%,100%{opacity:1}50%{opacity:.5}}.empty-state{display:flex;flex-direction:column;align-items:center;justify-content:center;height:100%;text-align:center;color:#6b7280}.empty-state-icon{font-size:3rem;margin-bottom:16px;opacity:.5}.hidden{display:none!important}.sr-only{position:absolute;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0,0,0,0);white-space:nowrap;border:0}.skip-link{position:absolute;top:-40px;left:6px;background:#3b82f6;color:#fff;padding:8px 16px;text-decoration:none;border-radius:4px;z-index:1000;font-weight:500}.skip-link:focus{top:6px}:focus{outline:#3b82f6 solid 2px;outline-offset:2px}.editor-title-input:focus,.editor:focus,.search-input:focus{outline:#3b82f6 solid 2px;outline-offset:1px;box-shadow:0 0 0 3px rgba(59,130,246,.1)}.encryption-indicator{color:#10b981;font-size:.8rem;margin-left:8px}.menu-container{position:relative}.menu-dropdown{position:absolute;top:100%;right:0;background:#fff;border:1px solid #e2e8f0;border-radius:8px;box-shadow:0 4px 12px rgba(0,0,0,.15);z-index:1000;min-width:200px;padding:8px 0;margin-top:4px}.menu-item{display:flex;align-items:center;gap:8px;width:100%;padding:12px 16px;border:none;background:0 0;text-align:left;font-size:14px;color:#374151;cursor:pointer;transition:background-color .2s}.menu-item:hover{background:#f3f4f6}.menu-separator{height:1px;background:#e5e7eb;margin:4px 0}.editor-content::-webkit-scrollbar,.editor-toolbar::-webkit-scrollbar,.note-list::-webkit-scrollbar,.sidebar::-webkit-scrollbar{width:6px;height:6px}.editor-content::-webkit-scrollbar-track,.editor-toolbar::-webkit-scrollbar-track,.note-list::-webkit-scrollbar-track,.sidebar::-webkit-scrollbar-track{background:#f1f5f9}.editor-content::-webkit-scrollbar-thumb,.editor-toolbar::-webkit-scrollbar-thumb,.note-list::-webkit-scrollbar-thumb,.sidebar::-webkit-scrollbar-thumb{background:#cbd5e1;border-radius:3px}.editor-content::-webkit-scrollbar-thumb:hover,.editor-toolbar::-webkit-scrollbar-thumb:hover,.note-list::-webkit-scrollbar-thumb:hover,.sidebar::-webkit-scrollbar-thumb:hover{background:#94a3b8}@media (max-width:1024px){.app-container{grid-template-columns:240px 280px 1fr}.header{padding:0 16px}.header-left{gap:16px}.search-container{max-width:220px;min-width:150px}}@media (max-width:768px){.app-container{grid-template-columns:1fr;grid-template-rows:auto 1fr}.header{padding:8px 16px;flex-wrap:wrap;min-height:auto;gap:12px}.header-left{gap:12px;width:100%;justify-content:space-between}.header h1{font-size:1.25rem}.search-container{max-width:200px;min-width:140px}.search-input{font-size:16px;padding:6px 12px 6px 32px}.search-icon{left:8px;font-size:.9rem}.header-controls{width:100%;justify-content:space-between;gap:8px}.encryption-controls{padding:6px 8px;font-size:.85rem}.encryption-controls label{font-size:.85rem}.btn{padding:6px 12px;font-size:.85rem}.note-list,.sidebar{display:none}.editor-toolbar{padding:8px 16px;gap:4px;justify-content:flex-start}.toolbar-group{gap:1px;padding:2px}.toolbar-btn{padding:4px 6px;font-size:.8rem;min-width:28px}.editor-content{padding:16px}.editor-header{padding:16px;flex-wrap:wrap;gap:8px}.editor-title-input{font-size:1.25rem}}@media (max-width:480px){.header{padding:8px 12px}.header-left{gap:8px}.search-container{max-width:120px;min-width:100px}.search-input{padding:4px 8px 4px 28px;font-size:14px}.header h1{font-size:1.1rem}.encryption-controls label{display:none}.btn{padding:4px 8px;font-size:.8rem}}@media (prefers-contrast:high){.note-item{border:2px solid #000}.note-item.active{background:#000;color:#fff}.toolbar-btn:hover{border:2px solid #000}}.modal-overlay{position:fixed;top:0;left:0;right:0;bottom:0;background:rgba(0,0,0,.5);display:flex;align-items:center;justify-content:center;z-index:1000;backdrop-filter:blur(2px)}.modal-content{background:#fff;border-radius:12px;max-width:500px;width:90vw;max-height:80vh;overflow-y:auto;box-shadow:0 20px 25px -5px rgba(0,0,0,.1),0 10px 10px -5px rgba(0,0,0,.04);animation:.3s ease-out modalSlideIn}@keyframes modalSlideIn{from{opacity:0;transform:scale(.9) translateY(-20px)}to{opacity:1;transform:scale(1) translateY(0)}}.modal-header{padding:24px 24px 16px;border-bottom:1px solid #e2e8f0;display:flex;align-items:center;justify-content:space-between}.modal-header h2{margin:0;font-size:1.5rem;font-weight:600;color:#1e293b}.modal-close{background:0 0;border:none;font-size:24px;cursor:pointer;color:#6b7280;padding:4px;border-radius:6px;transition:.2s;width:32px;height:32px;display:flex;align-items:center;justify-content:center}.modal-close:hover{background:#f1f5f9;color:#374151}.modal-body{padding:24px;line-height:1.6}.modal-body h3{color:#1e293b;margin:0 0 12px;font-size:1.25rem;font-weight:600}.modal-body p{margin:0 0 16px;color:#475569}.modal-body a{color:#3b82f6;text-decoration:none;font-weight:500}.modal-body a:hover{text-decoration:underline}.version-info{background:#f8fafc;border:1px solid #e2e8f0;border-radius:8px;padding:16px;margin:16px 0}.feature-list{list-style:none;padding:0;margin:16px 0}.feature-list li{padding:4px 0;color:#475569}.feature-list li::before{content:"‚Ä¢";color:#3b82f6;margin-right:8px;font-weight:700}@media (prefers-reduced-motion:reduce){*,::after,::before{animation-duration:0s!important;animation-iteration-count:1!important;transition-duration:0s!important}}</style></head><body><a href=#editor class=skip-link>Skip to main content</a><div class=app-container role=application aria-label="Notebook Application"><div class=header><div class=header-left><h1>üìù Notebook</h1><div class=search-container><span class=search-icon aria-hidden=true>üîç</span> <input class=search-input placeholder="Search notes..." id=searchInput aria-label="Search through your notes" autocomplete=off spellcheck=false></div></div><div class=header-controls><div class=encryption-controls><input type=checkbox id=encryptionEnabled onchange=toggleEncryption() aria-describedby=encryption-desc> <label for=encryptionEnabled>üîí Encrypt Notebook</label> <span id=encryption-desc class=sr-only>Enable password protection for your entire notebook</span></div><div class=menu-container><button class="btn btn-secondary" onclick=toggleMenu() id=menuBtn>‚öôÔ∏è Menu</button><div class="menu-dropdown hidden" id=menuDropdown><button class=menu-item onclick=checkForUpdates()>üîÑ Check for Updates</button><div class=menu-separator></div><button class=menu-item onclick=exportNotes()>üì§ Export Notes</button> <button class=menu-item onclick=importNotes()>üì• Import Notes</button><div class=menu-separator></div><button class=menu-item onclick=showAbout()>‚ÑπÔ∏è About</button></div></div><button class="btn btn-primary" onclick=downloadUpdatedFile() aria-label="Download and save your notebook file">üíæ Save File</button></div></div><div class=sidebar><div class=sidebar-section><h2>Categories</h2><div class=new-category-form><input class=new-category-input placeholder="New category" id=newCategoryInput> <button class="btn btn-primary" onclick=addCategory()>Add</button></div><ul class=category-list id=categoryList></ul></div></div><div class=note-list><div class=note-list-header><h2 class=note-list-title id=noteListTitle>All Notes</h2><button class="btn btn-primary" onclick=createNewNote()>+ New Note</button></div><div class=note-items id=noteItems></div></div><div class=editor-panel><div class=editor-header><input class=editor-title-input placeholder="Untitled Note" id=editorTitle> <span class="encryption-indicator hidden" id=encryptionIndicator>üîí Encrypted</span> <select class="btn btn-secondary" id=noteCategorySelect></select> <button class="btn btn-danger" onclick=deleteCurrentNote() id=deleteNoteBtn>Delete</button></div><div class=editor-toolbar><div class=toolbar-group><button class=toolbar-btn onclick="toggleFormat('bold')" title=Bold data-format=bold><strong>B</strong></button> <button class=toolbar-btn onclick="toggleFormat('italic')" title=Italic data-format=italic><em>I</em></button> <button class=toolbar-btn onclick="toggleFormat('underline')" title=Underline data-format=underline><u>U</u></button> <button class=toolbar-btn onclick="toggleFormat('strikeThrough')" title=Strikethrough data-format=strikeThrough><s>S</s></button></div><div class=toolbar-group><button class=toolbar-btn onclick="formatHeading('h1')" title="Heading 1" data-format=h1>H1</button> <button class=toolbar-btn onclick="formatHeading('h2')" title="Heading 2" data-format=h2>H2</button> <button class=toolbar-btn onclick="formatHeading('h3')" title="Heading 3" data-format=h3>H3</button> <button class=toolbar-btn onclick="formatHeading('p')" title="Normal Text" data-format=p>P</button></div><div class=toolbar-group><button class=toolbar-btn onclick="toggleFormat('insertUnorderedList')" title="Bullet List" data-format=insertUnorderedList>‚Ä¢ List</button> <button class=toolbar-btn onclick="toggleFormat('insertOrderedList')" title="Numbered List" data-format=insertOrderedList>1. List</button> <button class=toolbar-btn onclick=toggleCodeFormat() title="Code/Code Block" data-format=code>&lt;/&gt;</button> <button class=toolbar-btn onclick=toggleQuoteFormat() title=Quote data-format=quote>‚ùù</button></div><div class=toolbar-group><button class=toolbar-btn onclick="execCommand('justifyLeft')" title="Align Left">‚¨Ö</button> <button class=toolbar-btn onclick="execCommand('justifyCenter')" title=Center>‚¨Ñ</button> <button class=toolbar-btn onclick="execCommand('justifyRight')" title="Align Right">‚û°</button></div><div class=toolbar-group><button class=toolbar-btn onclick=createLink() title="Insert Link" data-format=createLink>üîó</button> <button class=toolbar-btn onclick=insertImage() title="Insert Image">üñº</button> <button class=toolbar-btn onclick=insertYouTubeVideo() title="YouTube Video">üìπ</button> <button class=toolbar-btn onclick=insertTable() title="Insert Table">üìä</button></div><div class=toolbar-group><button class=toolbar-btn onclick=clearFormatting() title="Clear Formatting">üßπ</button> <button class=toolbar-btn onclick=insertLineBreak() title="Line Break">‚Üµ</button></div></div><div class=editor-content><div class=editor contenteditable=true id=editor role=textbox aria-label="Note content editor" aria-multiline=true spellcheck=true></div></div><div class=status-bar><div class=auto-save-indicator><div class=save-dot id=saveDot></div><span id=saveStatus>All changes saved</span></div><div id=wordCount>0 words</div></div></div></div><div class=modal-overlay id=aboutModal style=display:none><div class=modal-content><div class=modal-header><h2>About Portable Notebook</h2><button class=modal-close onclick=closeAboutModal()>√ó</button></div><div class=modal-body id=aboutModalBody></div></div></div><script>const REPO_BASE_URL="https://github.com/TolinSimpson/Portable-Notebook";const CURRENT_VERSION="1.0.0";
// NOTES DATA - DO NOT EDIT MANUALLY
let NOTES_DATA={General:{17346372e5:{title:"Welcome to Notebook! üëã",content:'<h2>Getting Started</h2>\n                <p>Welcome to your new note-taking workspace! Here\'s how to get started:</p>\n                <ul>\n                <li><strong>Create notes:</strong> Click the "New Note" button</li>\n                <li><strong>Organize:</strong> Use categories to group your notes</li>\n                <li><strong>Search:</strong> Use the search bar to find notes quickly</li>\n                <li><strong>Format:</strong> Use the toolbar to style your text</li>\n                <li><strong>Encrypt:</strong> Enable notebook encryption for privacy</li>\n                </ul>\n                <p>Your notes are automatically saved as you type and work completely offline. Happy note-taking! ‚ú®</p>',lastModified:"2024-12-20T00:00:00.000Z",encrypted:!1}}};let CATEGORIES_DATA=["General"];
// END NOTES DATA
let notes=NOTES_DATA;let categories=CATEGORIES_DATA;let currentNote=null;let currentCategory="General";let searchQuery="";let autoSaveTimer=null;let pendingChanges=!1;let encryptionEnabled=!1;let encryptionKey=null;let notebookUnlocked=!1;async function init(){const e=Object.values(notes).some(e=>Object.values(e).some(e=>e.encrypted));if(e){encryptionEnabled=!0;document.getElementById("encryptionEnabled").checked=!0;try{const n=prompt("This notebook is encrypted. Enter your password to access it:");if(!n)return alert("Password required to access this notebook."),void 0;await unlockNotebook(n);notebookUnlocked=!0}catch(e){alert("Invalid password or corrupted data. Cannot access notebook.");return}}else notebookUnlocked=!0;updateCategoryList();updateNoteList();updateCategorySelect();setupEventListeners();const t=Object.keys(notes["General"]||{})[0];t&&selectNote(t)}function setupEventListeners(){document.getElementById("searchInput").addEventListener("input",e=>{searchQuery=e.target.value.toLowerCase();updateNoteList()});document.getElementById("editorTitle").addEventListener("input",scheduleAutoSave);document.getElementById("editor").addEventListener("input",scheduleAutoSave);document.getElementById("editor").addEventListener("input",updateWordCount);const e=document.getElementById("editor");e.addEventListener("keyup",updateToolbarState);e.addEventListener("mouseup",updateToolbarState);e.addEventListener("focus",updateToolbarState);e.addEventListener("keydown",handleEditorKeydown);e.addEventListener("keypress",handleEditorKeypress);document.addEventListener("click",e=>{const t=document.querySelector(".menu-container");const n=document.getElementById("menuDropdown");t.contains(e.target)||n.classList.add("hidden")});document.addEventListener("click",e=>{const t=document.getElementById("aboutModal");e.target===t&&closeAboutModal()});document.getElementById("noteCategorySelect").addEventListener("change",changeNoteCategory);document.getElementById("newCategoryInput").addEventListener("keypress",e=>{"Enter"===e.key&&addCategory()});window.addEventListener("beforeunload",e=>{if(pendingChanges){e.preventDefault();e.returnValue="You have unsaved changes. Save your notebook before leaving.";return"You have unsaved changes. Save your notebook before leaving."}})}function scheduleAutoSave(){setSaveStatus("saving");pendingChanges=!0;clearTimeout(autoSaveTimer);autoSaveTimer=setTimeout(()=>{if(currentNote){saveCurrentNote();setSaveStatus("pending")}},1e3)}function setSaveStatus(e){const t=document.getElementById("saveDot");const n=document.getElementById("saveStatus");if("saving"===e){t.classList.add("saving");n.innerHTML="Saving..."}else if("pending"===e){t.classList.remove("saving");t.style.background="#f59e0b";n.innerHTML='Changes ready - <button onclick="downloadUpdatedFile()" style="background:none;border:none;color:#3b82f6;cursor:pointer;text-decoration:underline;">Download File</button>'}else{t.classList.remove("saving");t.style.background="#10b981";n.textContent="All changes saved"}}function updateWordCount(){const e=document.getElementById("editor").textContent||"";const t=e.trim()?e.trim().split(/\s+/).length:0;document.getElementById("wordCount").textContent=t+" word"+(1!==t?"s":"")}async function downloadUpdatedFile(){let e="notebook.html";let t="";let n=!1;try{const s=window.location.href;if(s.startsWith("file://")){n=!0;const c=s.split("/");const i=c[c.length-1];i&&i.endsWith(".html")&&(e=decodeURIComponent(i));const l=decodeURIComponent(s.replace("file://",""));t=l.substring(0,l.lastIndexOf("/"))}else if(s.includes("/")){const d=s.split("/");const u=d[d.length-1];u&&(u.endsWith(".html")||u.endsWith(".htm"))&&(e=u)}}catch(e){}if(n){const m=confirm(`Save your notes to preserve changes!

`+`Current file: ${e}
`+`Location: ${t}

`+`Instructions:
`+`1. Click OK to download the updated file
`+`2. Save it to replace the original file at the same location
`+`3. Refresh this page to see your changes

`+"Continue with download?");if(!m)return}const htmlContent=await generateUpdatedHTML();const o=new Blob([htmlContent],{type:"text/html"});const r=URL.createObjectURL(o);const a=document.createElement("a");a.href=r;a.download=e;document.body.appendChild(a);a.click();document.body.removeChild(a);URL.revokeObjectURL(r);pendingChanges=!1;setSaveStatus("saved")}async function generateUpdatedHTML(){let htmlContent=document.documentElement.outerHTML;let notesToSave=JSON.parse(JSON.stringify(notes));if(encryptionEnabled&&encryptionKey)for(var[e,t]of Object.entries(notesToSave))for(var[n,o]of Object.entries(t))o.encrypted&&(o.content=await encryptText(o.content,encryptionKey));const notesDataRegex=/\/\/ NOTES DATA - DO NOT EDIT MANUALLY[\s\S]*?\/\/ END NOTES DATA/;const newNotesData=`// NOTES DATA - DO NOT EDIT MANUALLY
        let NOTES_DATA = ${JSON.stringify(notesToSave,null,0)};
        let CATEGORIES_DATA = ${JSON.stringify(categories,null,0)};
        // END NOTES DATA`;htmlContent=htmlContent.replace(notesDataRegex,newNotesData);return htmlContent}function addCategory(){const e=document.getElementById("newCategoryInput");const t=e.value.trim();if(t&&!categories.includes(t)){categories.push(t);updateCategoryList();updateCategorySelect();e.value="";scheduleAutoSave()}}function deleteCategory(t){if("General"!==t&&confirm(`Delete "${t}" category? Notes will be moved to General.`)){if(notes[t]){notes["General"]||(notes["General"]={});Object.assign(notes["General"],notes[t]);delete notes[t]}categories=categories.filter(e=>e!==t);currentCategory===t&&(currentCategory="General");updateCategoryList();updateNoteList();updateCategorySelect();scheduleAutoSave()}}function selectCategory(e){currentCategory=e;updateCategoryList();updateNoteList();document.getElementById("noteListTitle").textContent=e}function updateCategoryList(){const e=document.getElementById("categoryList");e.innerHTML=categories.map(e=>{const t=Object.keys(notes[e]||{}).length;return`
                    <li class="category-item ${e===currentCategory?"active":""}" 
                        onclick="selectCategory('${e}')">
                        <span class="category-name">${e}</span>
                        <span class="note-count">${t}</span>
                        ${"General"!==e?`<button class="delete-category" onclick="event.stopPropagation(); deleteCategory('${e}')">√ó</button>`:""}
                    </li>
                `}).join("")}function updateCategorySelect(){const e=document.getElementById("noteCategorySelect");e.innerHTML=categories.map(e=>`<option value="${e}">${e}</option>`).join("");if(currentNote)for(var[t,n]of Object.entries(notes))if(n[currentNote]){e.value=t;break}}async function createNewNote(){const e=Date.now().toString();let t="Untitled Note";let n="";notes[currentCategory]||(notes[currentCategory]={});notes[currentCategory][e]={title:t,content:n,lastModified:(new Date).toISOString(),encrypted:encryptionEnabled};selectNote(e);updateNoteList();scheduleAutoSave();setTimeout(()=>{document.getElementById("editorTitle").focus();document.getElementById("editorTitle").select()},100)}async function selectNote(e){let t=null;let n=null;for(var[o,r]of Object.entries(notes))if(r[e]){t=o;n=r[e];break}if(n){currentNote=e;currentCategory=t;document.getElementById("editorTitle").value=n.title;document.getElementById("editor").innerHTML=n.content;document.getElementById("noteCategorySelect").value=t;encryptionEnabled?document.getElementById("encryptionIndicator").classList.remove("hidden"):document.getElementById("encryptionIndicator").classList.add("hidden");updateNoteList();updateCategoryList();updateWordCount();pendingChanges||setSaveStatus("saved")}}async function saveCurrentNote(){if(currentNote){const o=document.getElementById("editorTitle").value.trim()||"Untitled Note";const r=document.getElementById("editor").innerHTML;let e=null;for(var[t,n]of Object.entries(notes))if(n[currentNote]){e=t;break}if(e){notes[e][currentNote]={title:o,content:r,lastModified:(new Date).toISOString(),encrypted:encryptionEnabled};updateNoteList();updateCategoryList()}}}function changeNoteCategory(){if(currentNote){const o=document.getElementById("noteCategorySelect").value;let e=null;for(var[t,n]of Object.entries(notes))if(n[currentNote]){e=t;break}if(e&&e!==o){const r=notes[e][currentNote];delete notes[e][currentNote];notes[o]||(notes[o]={});notes[o][currentNote]=r;currentCategory=o;updateNoteList();updateCategoryList();scheduleAutoSave()}}}function deleteCurrentNote(){if(currentNote&&confirm("Delete this note? This cannot be undone.")){for(var[e,t]of Object.entries(notes))if(t[currentNote]){delete t[currentNote];break}const n=Object.keys(notes[currentCategory]||{});if(0<n.length)selectNote(n[0]);else{currentNote=null;document.getElementById("editorTitle").value="";document.getElementById("editor").innerHTML=""}updateNoteList();updateCategoryList();scheduleAutoSave()}}function updateNoteList(){const e=document.getElementById("noteItems");const t=notes[currentCategory]||{};let n=Object.entries(t);searchQuery&&(n=n.filter(([,e])=>{const t=e.title.toLowerCase().includes(searchQuery);const n=e.content.replace(/<[^>]*>/g,"").toLowerCase();const o=n.includes(searchQuery);return t||o}));n.sort(([,e],[,t])=>new Date(t.lastModified)-new Date(e.lastModified));0===n.length?e.innerHTML=`
                    <div class="empty-state">
                        <div class="empty-state-icon">üìù</div>
                        <p>${searchQuery?"No notes found":"No notes yet"}</p>
                        ${searchQuery?"":"<p>Create your first note to get started!</p>"}
                    </div>
                `:e.innerHTML=n.map(([e,t])=>{const n=t.title||"Untitled Note";const o=t.content.replace(/<[^>]*>/g,"");const r=o.substring(0,100);const a=o.trim()?o.trim().split(/\s+/).length:0;const s=new Date(t.lastModified).toLocaleDateString();return`
                        <div class="note-item ${e===currentNote?"active":""}" 
                             onclick="selectNote('${e}')" role="button" tabindex="0">
                            <div class="note-title">${n}</div>
                            <div class="note-preview">${r}${100<=r.length?"...":""}</div>
                            <div class="note-meta">
                                <span>${s}</span>
                                <span>${a} word${1!==a?"s":""}</span>
                            </div>
                        </div>
                    `}).join("")}function execCommand(e,t=null){document.execCommand(e,!1,t);updateToolbarState();scheduleAutoSave()}function toggleFormat(e){if("insertUnorderedList"===e||"insertOrderedList"===e){const t=window.getSelection();if(0<t.rangeCount){const n=t.getRangeAt(0);const o=(n.commonAncestorContainer.nodeType===Node.TEXT_NODE?n.commonAncestorContainer.parentElement:n.commonAncestorContainer).closest("ul, ol");if(o){const r=o.querySelectorAll("li");const a=document.createDocumentFragment();r.forEach(e=>{const t=document.createElement("div");t.innerHTML=e.innerHTML;a.appendChild(t)});o.parentNode.replaceChild(a,o)}else execCommand(e)}}else execCommand(e);updateToolbarState()}function formatHeading(e){const t=window.getSelection();if(0<t.rangeCount){const n=t.getRangeAt(0);const o=n.commonAncestorContainer.nodeType===Node.TEXT_NODE?n.commonAncestorContainer.parentElement:n.commonAncestorContainer;const r=o.closest("h1, h2, h3, h4, h5, h6");r&&r.tagName.toLowerCase()===e?execCommand("formatBlock","p"):execCommand("formatBlock",e)}else execCommand("formatBlock",e);updateToolbarState()}function updateToolbarState(){const e=document.querySelectorAll(".toolbar-btn[data-format]");e.forEach(e=>{e.classList.remove("active");const t=e.getAttribute("data-format");if("h1"===t||"h2"===t||"h3"===t||"p"===t){const n=document.queryCommandValue("formatBlock").toLowerCase();n!==t&&("p"!==t||"div"!==n&&""!==n)||e.classList.add("active")}else if("insertUnorderedList"===t||"insertOrderedList"===t){const o="insertUnorderedList"===t?"ul":"ol";const r=window.getSelection();if(0<r.rangeCount){const a=r.getRangeAt(0);const s=(a.commonAncestorContainer.nodeType===Node.TEXT_NODE?a.commonAncestorContainer.parentElement:a.commonAncestorContainer).closest("ul, ol");s&&s.tagName.toLowerCase()===o&&e.classList.add("active")}}else if("createLink"===t){const c=window.getSelection();if(0<c.rangeCount){const i=c.getRangeAt(0);const l=i.commonAncestorContainer.nodeType===Node.TEXT_NODE?i.commonAncestorContainer.parentElement:i.commonAncestorContainer;l.closest("a")&&e.classList.add("active")}}else if("code"===t){const d=window.getSelection();if(0<d.rangeCount){const u=d.getRangeAt(0);const m=u.commonAncestorContainer.nodeType===Node.TEXT_NODE?u.commonAncestorContainer.parentElement:u.commonAncestorContainer;m.closest("code, pre")&&e.classList.add("active")}}else if("quote"===t){const p=window.getSelection();if(0<p.rangeCount){const g=p.getRangeAt(0);const f=g.commonAncestorContainer.nodeType===Node.TEXT_NODE?g.commonAncestorContainer.parentElement:g.commonAncestorContainer;f.closest("blockquote")&&e.classList.add("active")}}else document.queryCommandState(t)&&e.classList.add("active")})}function clearFormatting(){const e=window.getSelection();if(0!==e.rangeCount){if(e.isCollapsed){const t=document.getElementById("editor");const n=document.createRange();n.selectNodeContents(t);e.removeAllRanges();e.addRange(n)}execCommand("removeFormat");execCommand("formatBlock","p");setTimeout(()=>{cleanupFormatting()},10)}}function cleanupFormatting(){const n=document.getElementById("editor");const e=["font","span","div"];e.forEach(e=>{const t=n.querySelectorAll(e);t.forEach(e=>{const t=e.className&&e.className.trim();const n=e.style&&e.style.cssText;const o=e.id;if(!t&&!n&&!o){for(;e.firstChild;)e.parentNode.insertBefore(e.firstChild,e);e.parentNode.removeChild(e)}})});updateToolbarState()}function insertLineBreak(){const e=document.createElement("br");const t=window.getSelection();if(0<t.rangeCount){const n=t.getRangeAt(0);n.deleteContents();n.insertNode(e);n.setStartAfter(e);n.setEndAfter(e);t.removeAllRanges();t.addRange(n)}scheduleAutoSave()}function toggleCodeFormat(){const o=window.getSelection();if(0!==o.rangeCount){const r=o.getRangeAt(0);const a=o.toString();let e=null;let t=!1;let n=!1;if(r.commonAncestorContainer.nodeType===Node.TEXT_NODE){const s=r.commonAncestorContainer.parentElement;e=s.closest("code, pre")}else e=r.commonAncestorContainer.closest("code, pre");if(e){t="code"===e.tagName.toLowerCase()&&"pre"!==e.parentElement.tagName.toLowerCase();n="code"===e.tagName.toLowerCase()&&"pre"===e.parentElement.tagName.toLowerCase();n||"pre"!==e.tagName.toLowerCase()||(n=!0)}if(e){if(n){const c="pre"===e.tagName.toLowerCase()?e:e.closest("pre");if(c){const i=c.querySelector("code");const l=(i||c).textContent;const d=document.createTextNode(l);c.parentNode.replaceChild(d,c);const u=document.createRange();u.selectNodeContents(d);o.removeAllRanges();o.addRange(u)}}else if(t){const m=e.textContent;const p=document.createTextNode(m);e.parentNode.replaceChild(p,e);const g=document.createRange();g.selectNodeContents(p);o.removeAllRanges();o.addRange(g)}scheduleAutoSave()}else if(a){const f=a.includes("\n")||50<a.length;const y=f||confirm("Create code block? (Cancel for inline code)");if(y){const b=`<pre style="background: #f4f4f4; padding: 12px; border-radius: 4px; border-left: 4px solid #3b82f6; margin: 12px 0; overflow-x: auto; white-space: pre-wrap;"><code>${a.replace(/</g,"&lt;").replace(/>/g,"&gt;")}</code></pre>`;execCommand("insertHTML",b)}else{const h=`<code style="background: #f1f5f9; padding: 2px 4px; border-radius: 3px; font-family: Monaco, Menlo, monospace; font-size: 0.9em;">${a.replace(/</g,"&lt;").replace(/>/g,"&gt;")}</code>`;execCommand("insertHTML",h)}}else{const C=prompt("Enter your code:\n(Multi-line code will create a code block)");if(C){const E=C.includes("\n");if(E){const v=`<pre style="background: #f4f4f4; padding: 12px; border-radius: 4px; border-left: 4px solid #3b82f6; margin: 12px 0; overflow-x: auto; white-space: pre-wrap;"><code>${C.replace(/</g,"&lt;").replace(/>/g,"&gt;")}</code></pre>`;execCommand("insertHTML",v)}else{const w=`<code style="background: #f1f5f9; padding: 2px 4px; border-radius: 3px; font-family: Monaco, Menlo, monospace; font-size: 0.9em;">${C.replace(/</g,"&lt;").replace(/>/g,"&gt;")}</code>`;execCommand("insertHTML",w)}}}updateToolbarState()}}function toggleQuoteFormat(){const l=window.getSelection();if(0!==l.rangeCount){const n=l.getRangeAt(0);const d=l.toString();let e=null;if(n.commonAncestorContainer.nodeType===Node.TEXT_NODE){const t=n.commonAncestorContainer.parentElement;e=t.closest("blockquote")}else e=n.commonAncestorContainer.closest("blockquote");if(e){let t=null;if(n.commonAncestorContainer.nodeType===Node.TEXT_NODE){let e=n.commonAncestorContainer.parentElement;for(;e&&e!==document.body;){if(e.tagName&&"blockquote"===e.tagName.toLowerCase()){t=e;break}e=e.parentElement}}else{let e=n.commonAncestorContainer;for(;e&&e!==document.body;){if(e.tagName&&"blockquote"===e.tagName.toLowerCase()){t=e;break}e=e.parentElement}}if(t){const o=document.createDocumentFragment();for(;t.firstChild;)o.appendChild(t.firstChild);t.parentNode.replaceChild(o,t);d&&setTimeout(()=>{const n=document.getElementById("editor");const e=n.textContent;const o=e.indexOf(d);if(-1!==o){const r=document.createTreeWalker(n,NodeFilter.SHOW_TEXT,null,!1);let e=0;let t;for(;t=r.nextNode();){const a=t.textContent.length;if(e+a>o){const s=o-e;const c=Math.min(s+d.length,a);const i=document.createRange();i.setStart(t,s);i.setEnd(t,c);l.removeAllRanges();l.addRange(i);break}e+=a}}},10)}scheduleAutoSave()}else if(d){const r=`<blockquote style="border-left: 4px solid #3b82f6; padding-left: 16px; margin: 16px 0; font-style: italic; color: #6b7280; background: #f8fafc; padding: 12px 16px; border-radius: 0 4px 4px 0;">${d}</blockquote>`;execCommand("insertHTML",r)}else{const a=prompt("Enter your quote or citation:");if(a){const s=`<blockquote style="border-left: 4px solid #3b82f6; padding-left: 16px; margin: 16px 0; font-style: italic; color: #6b7280; background: #f8fafc; padding: 12px 16px; border-radius: 0 4px 4px 0;">${a}</blockquote>`;execCommand("insertHTML",s)}}updateToolbarState()}}function createLink(){const t=window.getSelection();if(0!==t.rangeCount){const o=t.getRangeAt(0);let e=null;e=(o.commonAncestorContainer.nodeType===Node.TEXT_NODE?o.commonAncestorContainer.parentElement:o.commonAncestorContainer).closest("a");if(!e&&!o.collapsed){const r=o.commonAncestorContainer;if(r.nodeType===Node.ELEMENT_NODE){const a=r.querySelectorAll("a");for(var n of a)if(o.intersectsNode(n)){e=n;break}}}if(e){const s=e.textContent;const c=document.createTextNode(s);e.parentNode.replaceChild(c,e);const i=document.createRange();i.selectNodeContents(c);t.removeAllRanges();t.addRange(i);scheduleAutoSave();updateToolbarState()}else{const l=t.toString();let e=prompt("Enter the URL:\n(Include http:// or https://)","https://");if(e&&"https://"!==e){e.match(/^https?:\/\//)||(e="https://"+e);const d=`<a href="${e}" target="_blank" rel="noopener noreferrer">${l||e}</a>`;execCommand("insertHTML",d);updateToolbarState()}}}}function insertImage(){const e=prompt("Enter image URL:\n(Supports JPG, PNG, GIF, WebP formats)","https://");if(e&&"https://"!==e){const t=`<img src="${e}" style="max-width: 100%; height: auto; border-radius: 4px; margin: 8px 0; box-shadow: 0 2px 8px rgba(0,0,0,0.1);" alt="Image" loading="lazy">`;execCommand("insertHTML",t)}}function insertYouTubeVideo(){const t=prompt("Enter YouTube URL:","https://www.youtube.com/watch?v=");if(t&&"https://www.youtube.com/watch?v="!==t){let e="";const o=[/youtube\.com\/watch\?v=([^&]+)/,/youtu\.be\/([^?]+)/,/youtube\.com\/embed\/([^?]+)/];for(var n of o){const r=t.match(n);if(r){e=r[1];break}}if(e){const a=`<div style="position: relative; width: 100%; max-width: 560px; height: 0; padding-bottom: 31.5%; margin: 16px auto; border-radius: 8px; overflow: hidden; background: #000; box-shadow: 0 4px 12px rgba(0,0,0,0.1);"><iframe src="https://www.youtube-nocookie.com/embed/${e}" style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; border: none;" allowfullscreen loading="lazy"></iframe></div>`;execCommand("insertHTML",a)}else alert("Invalid YouTube URL. Please enter a valid YouTube link.")}}function insertTable(){const e=parseInt(prompt("Number of rows:","3"));const o=parseInt(prompt("Number of columns:","3"));if(e&&o&&0<e&&0<o&&e<=20&&o<=10){let n='<table style="border-collapse: collapse; width: 100%; margin: 16px 0; border: 1px solid #e2e8f0; border-radius: 6px; overflow: hidden;">';for(let t=0;t<e;t++){n+="<tr>";for(let e=0;e<o;e++){const r=0===t;const a="border: 1px solid #e2e8f0; padding: 12px; "+(r?"background: #f8fafc; font-weight: 600;":"");const s=r?"Header "+(e+1):"";n+=`<${r?"th":"td"} style="${a}">${s}</${r?"th":"td"}>`}n+="</tr>"}n+="</table>";execCommand("insertHTML",n)}else(20<e||10<o)&&alert("Table size limited to 20 rows and 10 columns for performance.")}async function deriveKey(e,t){const n=new TextEncoder;const o=await crypto.subtle.importKey("raw",n.encode(e),{name:"PBKDF2"},!1,["deriveBits","deriveKey"]);return crypto.subtle.deriveKey({name:"PBKDF2",salt:t,iterations:1e5,hash:"SHA-256"},o,{name:"AES-GCM",length:256},!1,["encrypt","decrypt"])}async function encryptText(e,t){const n=new TextEncoder;const o=crypto.getRandomValues(new Uint8Array(16));const r=crypto.getRandomValues(new Uint8Array(12));const a=await deriveKey(t,o);const s=await crypto.subtle.encrypt({name:"AES-GCM",iv:r},a,n.encode(e));const c=new Uint8Array(o.length+r.length+s.byteLength);c.set(o,0);c.set(r,o.length);c.set(new Uint8Array(s),o.length+r.length);return btoa(String.fromCharCode.apply(null,c))}async function decryptText(e,t){try{const n=new Uint8Array(atob(e).split("").map(e=>e.charCodeAt(0)));const o=n.slice(0,16);const r=n.slice(16,28);const a=n.slice(28);const s=await deriveKey(t,o);const c=await crypto.subtle.decrypt({name:"AES-GCM",iv:r},s,a);return(new TextDecoder).decode(c)}catch(e){throw new Error("Decryption failed - invalid password or corrupted data")}}async function unlockNotebook(e){for(var[t,n]of Object.entries(notes))for(var[o,r]of Object.entries(n))if(r.encrypted){r.content=await decryptText(r.content,e);r.encrypted=!1}encryptionKey=e}async function toggleEncryption(){const e=document.getElementById("encryptionEnabled");const t=encryptionEnabled;encryptionEnabled=e.checked;if(encryptionEnabled&&!t){const d=prompt("Enter a password for the notebook:\n\n‚ö†Ô∏è Important: Remember this password! You will need it to access this notebook.");if(d)if(d.length<4){alert("Password must be at least 4 characters long.");e.checked=!1;encryptionEnabled=!1}else{encryptionKey=d;for(var[n,o]of Object.entries(notes))for(var[r,a]of Object.entries(o))a.encrypted=!0;scheduleAutoSave();alert("Notebook encryption enabled! Notes will be encrypted when you save the file.")}else{e.checked=!1;encryptionEnabled=!1}}else if(!encryptionEnabled&&t){const u=confirm("Disable notebook encryption? This will remove password protection from all notes.");if(u){for(var[s,c]of Object.entries(notes))for(var[i,l]of Object.entries(c))l.encrypted=!1;encryptionKey=null;scheduleAutoSave();alert("Notebook encryption disabled.")}else{e.checked=!0;encryptionEnabled=!0}}}function handleEditorKeydown(e){if(e.ctrlKey||e.metaKey)switch(e.key.toLowerCase()){case"b":e.preventDefault();toggleFormat("bold");break;case"i":e.preventDefault();toggleFormat("italic");break;case"u":e.preventDefault();toggleFormat("underline");break;case"\\":e.preventDefault();clearFormatting();break;case"enter":e.preventDefault();insertLineBreak()}if("Backspace"===e.key){const t=window.getSelection();if(0<t.rangeCount){const n=t.getRangeAt(0);if(n.collapsed&&0===n.startOffset){const o=n.startContainer.nodeType===Node.TEXT_NODE?n.startContainer.parentElement:n.startContainer;if(o.tagName&&["STRONG","B","EM","I","U","STRIKE","S"].includes(o.tagName)){e.preventDefault();n.setStartBefore(o);n.setEndBefore(o);t.removeAllRanges();t.addRange(n);if(0<n.startOffset){n.setStart(n.startContainer,n.startOffset-1);n.deleteContents()}}}}}}function handleEditorKeypress(e){if("Enter"===e.key){const t=window.getSelection();if(0<t.rangeCount){const n=t.getRangeAt(0);const o=n.commonAncestorContainer.nodeType===Node.TEXT_NODE?n.commonAncestorContainer.parentElement:n.commonAncestorContainer;const r=o.closest("h1, h2, h3, h4, h5, h6");if(r){e.preventDefault();const a=document.createElement("p");a.innerHTML="<br>";if(n.endOffset!==r.textContent.length){const c=r.textContent.substring(n.endOffset);r.textContent=r.textContent.substring(0,n.endOffset);a.textContent=c}r.parentNode.insertBefore(a,r.nextSibling);const s=document.createRange();s.setStart(a,0);s.setEnd(a,0);t.removeAllRanges();t.addRange(s);scheduleAutoSave()}}}}function toggleMenu(){const e=document.getElementById("menuDropdown");e.classList.toggle("hidden")}async function checkForUpdates(){const t=REPO_BASE_URL+"/releases";try{const e=setTimeout(()=>{alert("Checking for updates...")},500);const n=REPO_BASE_URL.replace("https://github.com/","https://api.github.com/repos/");const o=await fetch(n+"/releases/latest");clearTimeout(e);if(!o.ok)throw new Error("GitHub API responded with status: "+o.status);const r=await o.json();const a=r.tag_name.replace(/^v./,"");if(0<compareVersions(a,CURRENT_VERSION)){const s=`üÜï Update Available!

`+`Current version: ${CURRENT_VERSION}
`+`Latest version: ${a}

`+`Release: ${r.name}

`+"Would you like to open the releases page to download the update?";confirm(s)&&window.open(t,"_blank","noopener,noreferrer")}else alert(`‚úÖ You're up to date!

Current version: ${CURRENT_VERSION}
Latest version: `+a)}catch(e){console.error("Error checking for updates:",e);const c=`‚ùå Could not check for updates automatically.

`+`Error: ${e.message}

`+"Would you like to open the releases page manually?";confirm(c)&&window.open(t,"_blank","noopener,noreferrer")}document.getElementById("menuDropdown").classList.add("hidden")}function compareVersions(e,t){const n=e.split(".").map(Number);const o=t.split(".").map(Number);const r=Math.max(n.length,o.length);for(;n.length<r;)n.push(0);for(;o.length<r;)o.push(0);for(let e=0;e<r;e++){if(n[e]>o[e])return 1;if(n[e]<o[e])return-1}return 0}function exportNotes(){try{const e={version:"1.0",exportDate:(new Date).toISOString(),notes:notes,categories:categories,encrypted:encryptionEnabled};const t=JSON.stringify(e,null,2);const n=new Blob([t],{type:"application/json"});const o=URL.createObjectURL(n);const r=document.createElement("a");r.href=o;r.download=`notebook-export-${(new Date).toISOString().split("T")[0]}.json`;document.body.appendChild(r);r.click();document.body.removeChild(r);URL.revokeObjectURL(o);alert("Notes exported successfully!")}catch(e){alert("Error exporting notes: "+e.message)}document.getElementById("menuDropdown").classList.add("hidden")}function importNotes(){const e=document.createElement("input");e.type="file";e.accept=".json";e.onchange=async e=>{const t=e.target.files[0];if(t)try{const n=await t.text();const o=JSON.parse(n);if(!o.notes||!o.categories)throw new Error("Invalid export file format");const r=confirm("Import options:\n\nOK = Replace all existing notes\nCancel = Merge with existing notes\n\nNote: Merging may create duplicate categories.");if(r){notes=o.notes;categories=o.categories}else{Object.keys(o.notes).forEach(e=>{notes[e]||(notes[e]={});Object.assign(notes[e],o.notes[e])});o.categories.forEach(e=>{categories.includes(e)||categories.push(e)})}if(o.encrypted&&!encryptionEnabled){const a=confirm("The imported notes are encrypted. Would you like to enable encryption for this notebook?");if(a){document.getElementById("encryptionEnabled").checked=!0;encryptionEnabled=!0}}currentCategory="General";currentNote=null;updateCategoryList();updateNoteList();updateCategorySelect();document.getElementById("editorTitle").value="";document.getElementById("editor").innerHTML="";scheduleAutoSave();alert(`Notes imported successfully!

Imported: ${Object.keys(o.notes).length} categories`)}catch(e){alert("Error importing notes: "+e.message)}};e.click();document.getElementById("menuDropdown").classList.add("hidden")}function showAbout(){const e=document.getElementById("aboutModalBody");e.innerHTML=`
                <div class="version-info">
                    <h3>üìù Portable Notebook v${CURRENT_VERSION}</h3>
                    <p><strong>Original Creator:</strong> Tolin Simpson</p>
                    <p><strong>Repository:</strong> <a href="${REPO_BASE_URL}" target="_blank">GitHub</a></p>
                    <p><strong>License:</strong> <a href="${REPO_BASE_URL}/tree/main?tab=MIT-1-ov-file#readme" target="_blank">MIT</a></p>
                </div>
            `;document.getElementById("aboutModal").style.display="flex";document.getElementById("menuDropdown").classList.add("hidden")}function closeAboutModal(){document.getElementById("aboutModal").style.display="none"}window.addEventListener("load",init);</script></body></html>